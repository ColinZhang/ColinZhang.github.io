<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
      <title> SSH behine firewall made easy &middot; fz84 </title>
  

  
  <link rel="stylesheet" href="http://fanzy.me/css/screen.css">

    
  



<link href="/css/themes/blackboard.css" rel="stylesheet" type="text/css">
<script src="/js/rainbow-custom.min.js"></script>
<script src="/js/rainbow.linenumbers.min.js"></script>

<link rel="stylesheet" href="/css/code.css">


  
  <link rel="stylesheet" href="http://fanzy.me/font-awesome/css/font-awesome.min.css">

  
  <link href="" rel="alternate" type="application/rss+xml" title="fz84" />
</head>

<body>

<div class="sidebar">
    <div class="container"> 
    <div class="sidebar-about">
      <h1>fz84</h1>
      <p class="lead">
       
        Read, write and do research in systems and security 
      
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
        <li><a href="/about/"> About </a></li>
      
        <li><a href="/post/"> Blogs </a></li>
      
    </ul>

    <p class="sidebar-copyright">
    &copy; 2015. All rights reserved. </p>
  </div>
</div>


<div class="content container">
<div class="post">
  <h1 class="title">SSH behine firewall made easy</h1>
   
  <span class="post-date">Tue, Jul 7, 2015</span>
  

      

<h1 id="settings:f8b878aefe833ac195c03c37c2641d27">Settings</h1>

<pre><code>(Desktop)---(Intermediate Server)--- || --- (Remote Server)
</code></pre>

<h1 id="step-by-step-setup:f8b878aefe833ac195c03c37c2641d27">Step-by-step setup</h1>

<h2 id="setup-reverse-tunnel:f8b878aefe833ac195c03c37c2641d27">setup reverse tunnel</h2>

<ol>
<li><p>on CU desktop</p>

<pre><code>ssh -fN -R 7000:localhost:22 -i aws-key.pem ec2-user@52.10.241.71
</code></pre></li>

<li><p>To test whether reverse tunnel works, on AWS Server:</p>

<pre><code>ssh fanz@localhost -p 7000 
</code></pre></li>
</ol>

<p>If prompted with login. Works.</p>

<h2 id="setup-proxycommand:f8b878aefe833ac195c03c37c2641d27">Setup <code>ProxyCommand</code></h2>

<p>on Laptop, add the following to ~/.ssh/config</p>

<pre><code>Host aws-ssh
    HostName 52.10.241.71
    User ec2-user
    IdentityFile ~/Dropbox/keys/Fan.pem

Host cs
    User fanz
    ProxyCommand ssh -W localhost:7000 aws-ssh
</code></pre>

<p>Then, simply try <code>ssh cs</code>. Should works!</p>

</div>

<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'FZ84';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>
</body>
</html>
